apiVersion: groups.gitlab.crossplane.io/v1alpha1
kind: Group
metadata:
  name: group
spec:
  forProvider:
    name: "Top level test group"
    path: ($namespace)
    visibility: "internal"
    removeFinalizerOnPendingDeletion: true
  providerConfigRef:
    name: default
---
apiVersion: groups.gitlab.crossplane.io/v1alpha1
kind: Group
metadata:
  name: group-a
spec:
  forProvider:
    name: "Test Group A"
    path: "cluster-test-group-a"
    visibility: "private"
    removeFinalizerOnPendingDeletion: true
    parentIdRef:
      name: group
  providerConfigRef:
    name: default
---
apiVersion: groups.gitlab.crossplane.io/v1alpha1
kind: Group
metadata:
  name: group-b
  labels:
    app: test-group-b
spec:
  forProvider:
    name: "Test Group B"
    path: "cluster-test-group-b"
    visibility: "private"
    removeFinalizerOnPendingDeletion: true
    parentIdRef:
      name: group
  providerConfigRef:
    name: default
---
apiVersion: groups.gitlab.crossplane.io/v1alpha1
kind: Group
metadata:
  name: group-c
spec:
  forProvider:
    name: "Test Group C"
    path: "cluster-test-group-c"
    visibility: "private"
    removeFinalizerOnPendingDeletion: true
    parentIdRef:
      name: group
    sharedWithGroups:
    - groupIdRef:
        name: group-a
      groupAccessLevel: 30  # Developer
    - groupIdSelector:
        matchLabels:
          app: test-group-b
      groupAccessLevel: 30  # Developer
  providerConfigRef:
    name: default
---
apiVersion: groups.gitlab.crossplane.io/v1alpha1
kind: AccessToken
metadata:
  name: test-group-accesstoken-1
spec:
  forProvider:
    name: "test-group-access-token-1"
    scopes: ["read_api"]
    expiresAt: "2026-01-01T00:00:00Z"
    groupIdRef:
      name: group-a
  writeConnectionSecretToRef:
    name: test-group-access-token-1-secret
    namespace: ($namespace)
  providerConfigRef:
    name: default
---
apiVersion: groups.gitlab.crossplane.io/v1alpha1
kind: DeployToken
metadata:
  name: test-group-deploytoken-1
spec:
  forProvider:
    scopes: ["read_repository"]
    groupIdRef:
      name: group-a
  writeConnectionSecretToRef:
    name: test-group-deploytoken-1-secret
    namespace: ($namespace)
  providerConfigRef:
    name: default
---
apiVersion: groups.gitlab.crossplane.io/v1alpha1
kind: Member
metadata:
  name: test-group-member-1
spec:
  forProvider:
    userID: 1
    accessLevel: 30
    groupIdRef:
      name: group-b
  providerConfigRef:
    name: default
---
apiVersion: groups.gitlab.crossplane.io/v1alpha1
kind: Variable
metadata:
  name: test-group-variable-1
spec:
  forProvider:
    key: "TEST_GROUP_VAR_1"
    value: "test-value-1"
    groupIdRef:
      name: group-c
  providerConfigRef:
    name: default
